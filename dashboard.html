<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edit your bio ‚Äî nightbio.lol</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' fill='%234a3f6b'/><text x='16' y='22' font-size='18' text-anchor='middle' fill='%237c6bb8' font-family='sans-serif'>n</text></svg>">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="admin.css">
</head>
<body class="dashboard-page">
  <div class="translate-wrapper" aria-label="Translate page">
    <span class="translate-label">Language</span>
    <select class="lang-select" id="customLangSelect" aria-label="Select language">
      <option value="">Select language</option>
      <option value="en">English</option>
      <option value="es">Spanish</option>
      <option value="fr">French</option>
      <option value="de">German</option>
      <option value="it">Italian</option>
      <option value="pt">Portuguese</option>
      <option value="ru">Russian</option>
      <option value="ja">Japanese</option>
      <option value="ko">Korean</option>
      <option value="zh-CN">Chinese (Simplified)</option>
      <option value="zh-TW">Chinese (Traditional)</option>
      <option value="ar">Arabic</option>
      <option value="hi">Hindi</option>
      <option value="nl">Dutch</option>
      <option value="pl">Polish</option>
      <option value="tr">Turkish</option>
      <option value="vi">Vietnamese</option>
      <option value="th">Thai</option>
      <option value="id">Indonesian</option>
      <option value="sv">Swedish</option>
      <option value="no">Norwegian</option>
      <option value="da">Danish</option>
      <option value="fi">Finnish</option>
    </select>
    <div id="google_translate_element"></div>
  </div>
  <div class="bg-gradient"></div>
  <div class="bg-grid"></div>
  <div class="dashboard-bg" aria-hidden="true">
    <div class="dashboard-bg-gradient"></div>
    <div class="dashboard-bg-orbs">
      <div class="dashboard-orb dashboard-orb-1"></div>
      <div class="dashboard-orb dashboard-orb-2"></div>
      <div class="dashboard-orb dashboard-orb-3"></div>
      <div class="dashboard-orb dashboard-orb-4"></div>
    </div>
    <div class="dashboard-bg-grid"></div>
    <div class="dashboard-bg-noise"></div>
  </div>

  <header class="editor-header">
    <a href="index" class="editor-logo">
      <span class="logo-text">nightbio</span>
    </a>
    <div class="editor-url-strip" id="bioUrlStrip" style="display: none;">
      <span class="editor-url-label">Your link</span>
      <input type="text" class="editor-url-input" id="bioUrlInput" readonly value="" aria-label="Your bio URL">
      <button type="button" class="editor-copy-btn" id="copyBioUrlBtn">Copy</button>
      <a href="#" class="editor-view-btn" id="viewBioBtn" target="_blank" rel="noopener">View profile</a>
    </div>
    <div class="editor-actions">
      <span id="editorMessage" class="editor-msg empty"></span>
      <button type="button" class="btn btn-primary editor-save-btn" id="saveBioBtn">Save changes</button>
      <button type="button" class="btn btn-ghost editor-logout-btn" id="logoutBtn">Log out</button>
    </div>
  </header>

  <main class="editor-main">
    <div class="editor-side">
      <nav class="editor-tabs" role="tablist">
        <button type="button" class="editor-tab active" role="tab" id="tabProfile" aria-selected="true" data-tab="profile">Profile</button>
        <button type="button" class="editor-tab" role="tab" id="tabLinks" aria-selected="false" data-tab="links">Links</button>
        <button type="button" class="editor-tab" role="tab" id="tabAppearance" aria-selected="false" data-tab="appearance">Appearance</button>
        <button type="button" class="editor-tab" role="tab" id="tabAnalytics" aria-selected="false" data-tab="analytics">Analytics</button>
        <button type="button" class="editor-tab" role="tab" id="tabSeo" aria-selected="false" data-tab="seo">SEO</button>
        <button type="button" class="editor-tab" role="tab" id="tabBadges" aria-selected="false" data-tab="badges">Badges</button>
        <button type="button" class="editor-tab" role="tab" id="tabStatus" aria-selected="false" data-tab="status">Status</button>
        <button type="button" class="editor-tab editor-tab-premium" role="tab" id="tabPremium" aria-selected="false" data-tab="premium" style="display: none;">Premium</button>
        <button type="button" class="editor-tab editor-tab-staff" role="tab" id="tabAdminPanel" aria-selected="false" data-tab="adminPanel" style="display: none;">Admin panel</button>
      </nav>

      <div class="editor-panels">
        <!-- Profile tab -->
        <section class="editor-panel active" id="panelProfile" role="tabpanel" aria-labelledby="tabProfile">
          <div class="panel-card">
            <h2 class="panel-title">Profile picture &amp; banner</h2>
            <p class="panel-desc">Paste an image URL for your profile photo and cover image.</p>
            <div class="media-upload-grid">
              <div class="media-upload-box avatar-upload-box">
                <div class="media-preview-wrap">
                  <img id="avatarPreview" class="media-preview avatar-preview-img" src="" alt="" style="display: none;">
                  <div class="media-placeholder" id="avatarPlaceholder">
                    <span class="media-placeholder-icon">üë§</span>
                    <span>Profile photo</span>
                  </div>
                </div>
                <label for="avatarURLInput" class="form-label-inline">Profile picture URL</label>
                <input type="url" id="avatarURLInput" placeholder="https://..." class="form-input" maxlength="500">
              </div>
              <div class="media-upload-box banner-upload-box">
                <div class="media-preview-wrap banner-preview-wrap">
                  <img id="bannerPreview" class="media-preview banner-preview-img" src="" alt="" style="display: none;">
                  <div class="media-placeholder banner-placeholder" id="bannerPlaceholder">
                    <span class="media-placeholder-icon">üñº</span>
                    <span>Cover image</span>
                  </div>
                </div>
                <label for="bannerURLInput" class="form-label-inline">Cover image URL</label>
                <input type="url" id="bannerURLInput" placeholder="https://..." class="form-input" maxlength="500">
              </div>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Handle</h2>
            <p class="panel-desc">Your profile URL is nightbio.lol/bio?u=<strong id="currentHandleDisplay">‚Äî</strong>. You can change your handle once every 7 days, and the new handle must not already be in use.</p>
            <div class="form-group">
              <label for="newHandleInput">New handle</label>
              <div class="handle-change-row">
                <input type="text" id="newHandleInput" class="form-input" placeholder="e.g. myname" minlength="3" maxlength="20" pattern="[a-zA-Z0-9_]+" autocomplete="username">
                <button type="button" class="btn btn-primary" id="changeHandleBtn">Change handle</button>
              </div>
              <p id="handleChangeMsg" class="form-hint" aria-live="polite" style="margin-top: 0.35rem;"></p>
              <p id="handleCooldownMsg" class="panel-desc" style="margin-top: 0.5rem; font-size: 0.85rem;"></p>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Alias</h2>
            <p class="panel-desc">An alias works like a second link to your profile (e.g. nightbio.lol/<strong id="currentAliasDisplay">‚Äî</strong>). Visitors are redirected to your main handle. You can change it once every 7 days, and it must not be in use as a handle or by someone else.</p>
            <div class="form-group">
              <label for="newAliasInput">Alias</label>
              <div class="handle-change-row">
                <input type="text" id="newAliasInput" class="form-input" placeholder="e.g. myalias or leave empty to remove" minlength="0" maxlength="20" pattern="[a-zA-Z0-9_]*" autocomplete="off">
                <button type="button" class="btn btn-primary" id="changeAliasBtn">Change alias</button>
              </div>
              <p id="aliasChangeMsg" class="form-hint" aria-live="polite" style="margin-top: 0.35rem;"></p>
              <p id="aliasCooldownMsg" class="panel-desc" style="margin-top: 0.5rem; font-size: 0.85rem;"></p>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Display info</h2>
            <div class="form-group">
              <label for="displayName">Display name</label>
              <input type="text" id="displayName" placeholder="How you want to be known" maxlength="80">
            </div>
            <div class="form-group">
              <label for="bioText">Bio</label>
              <textarea id="bioText" placeholder="Short bio ‚Äî introduce yourself (max 500 characters)" maxlength="500" rows="4"></textarea>
              <span class="char-count"><span id="bioCharCount">0</span>/500</span>
            </div>
            <div class="form-group">
              <label for="songURLInput">Profile song (optional)</label>
              <p class="panel-desc" style="margin-bottom: 0.5rem;">Paste a Spotify track, album, or playlist link. It will be embedded on your profile so visitors can play it there.</p>
              <input type="url" id="songURLInput" placeholder="https://open.spotify.com/track/..." class="form-input" maxlength="500">
            </div>
          </div>
        </section>

        <!-- Links tab -->
        <section class="editor-panel" id="panelLinks" role="tabpanel" aria-labelledby="tabLinks" hidden>
          <div class="panel-card">
            <div class="panel-title-row">
              <h2 class="panel-title">Your links</h2>
              <span class="link-count-badge" id="linkCountBadge">0 / 20</span>
            </div>
            <p class="panel-desc">Add buttons that link to your socials, store, or anything else. Drag to reorder.</p>
            <ul class="link-list" id="linkList"></ul>
            <button type="button" class="btn btn-ghost add-link-btn" id="addLinkBtn">
              <span class="btn-icon-left">+</span> Add link
            </button>
          </div>
        </section>

        <!-- Appearance tab -->
        <section class="editor-panel" id="panelAppearance" role="tabpanel" aria-labelledby="tabAppearance" hidden>
          <div class="panel-card">
            <h2 class="panel-title">Template</h2>
            <p class="panel-desc">Apply a preset look (color, font) in one click.</p>
            <div class="form-group">
              <label for="templateSelect">Preset</label>
              <select id="templateSelect" class="form-select">
                <option value="">Custom (no preset)</option>
                <option value="minimal">Minimal</option>
                <option value="classic">Classic</option>
                <option value="neon">Neon</option>
                <option value="warm">Warm</option>
              </select>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Display style</h2>
            <p class="panel-desc">Show your bio full-width or inside a centered card.</p>
            <div class="form-group">
              <label for="displayStyleSelect">Display</label>
              <select id="displayStyleSelect" class="form-select">
                <option value="default">Full page</option>
                <option value="card">Card / modal</option>
              </select>
            </div>
            <div id="modalOptionsWrap" class="modal-options-wrap" style="display: none;">
              <h3 class="panel-subtitle">Card appearance</h3>
              <div class="form-group">
                <label for="modalBackgroundMode">Card background</label>
                <select id="modalBackgroundMode" class="form-select">
                  <option value="solid">Solid color</option>
                  <option value="gradient">2-color gradient</option>
                </select>
              </div>
              <div id="modalSolidColorWrap" class="form-group">
                <label for="modalBackgroundColor">Card color</label>
                <div class="color-picker-wrap">
                  <input type="color" id="modalBackgroundColor" value="#12121a" aria-label="Card color">
                  <input type="text" id="modalBackgroundColorHex" class="color-hex-input" value="#12121a" maxlength="7" placeholder="#12121a">
                </div>
              </div>
              <div id="modalGradientWrap" class="form-group" style="display: none;">
                <label for="modalGradientColor1">Gradient color 1</label>
                <div class="color-picker-wrap">
                  <input type="color" id="modalGradientColor1" value="#1a1a24" aria-label="Gradient color 1">
                  <input type="text" id="modalGradientColor1Hex" class="color-hex-input" value="#1a1a24" maxlength="7">
                </div>
                <label for="modalGradientColor2">Gradient color 2</label>
                <div class="color-picker-wrap">
                  <input type="color" id="modalGradientColor2" value="#12121a" aria-label="Gradient color 2">
                  <input type="text" id="modalGradientColor2Hex" class="color-hex-input" value="#12121a" maxlength="7">
                </div>
              </div>
              <div class="form-group">
                <label for="modalOpacity">Background opacity (%)</label>
                <input type="range" id="modalOpacity" min="20" max="100" value="96" class="form-range">
                <span id="modalOpacityValue" class="form-range-value">96%</span>
              </div>
              <div class="form-group">
                <label for="modalBlur">Backdrop blur (px)</label>
                <input type="range" id="modalBlur" min="0" max="24" value="0" class="form-range">
                <span id="modalBlurValue" class="form-range-value">0</span>
              </div>
              <div class="form-group">
                <label for="modalBorderOpacity">Border opacity (%)</label>
                <input type="range" id="modalBorderOpacity" min="0" max="100" value="20" class="form-range">
                <span id="modalBorderOpacityValue" class="form-range-value">20%</span>
              </div>
              <div class="form-group">
                <label for="modalRadius">Corner radius (px)</label>
                <input type="number" id="modalRadius" min="8" max="32" value="24" class="form-input-num">
              </div>
            </div>
            <div class="form-group form-check">
              <input type="checkbox" id="clickToEnter" class="form-checkbox" aria-describedby="clickToEnterDesc">
              <label for="clickToEnter">Click to enter</label>
              <p id="clickToEnterDesc" class="panel-desc">Visitors must click to see your bio (like guns.lol). Shows a full-screen ‚ÄúEnter‚Äù screen until they click.</p>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Theme</h2>
            <div class="form-group">
              <label for="accentColor">Accent color</label>
              <div class="color-picker-wrap">
                <input type="color" id="accentColor" value="#7c6bb8" aria-label="Accent color">
                <input type="text" id="accentColorHex" class="color-hex-input" value="#7c6bb8" maxlength="7" placeholder="#7c6bb8">
              </div>
            </div>
            <div class="form-group">
              <label for="buttonStyle">Button style</label>
              <select id="buttonStyle" class="form-select">
                <option value="filled">Filled</option>
                <option value="outline">Outline</option>
              </select>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Typography</h2>
            <div class="form-group">
              <label for="fontFamily">Font</label>
              <select id="fontFamily" class="form-select">
                <option value="Outfit">Outfit</option>
                <option value="Inter">Inter</option>
                <option value="Space Mono">Space Mono</option>
                <option value="Poppins">Poppins</option>
                <option value="DM Sans">DM Sans</option>
                <option value="Playfair Display">Playfair Display</option>
              </select>
            </div>
            <div class="form-group form-row">
              <div>
                <label for="fontSize">Font size</label>
                <input type="number" id="fontSize" min="12" max="24" value="16" class="form-input-num">
              </div>
              <div>
                <label for="letterSpacing">Letter spacing</label>
                <input type="number" id="letterSpacing" min="-1" max="2" step="0.1" value="0" class="form-input-num">
              </div>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Background</h2>
            <div class="form-group">
              <label for="backgroundEffect">Effect</label>
              <select id="backgroundEffect" class="form-select">
                <option value="none">None</option>
                <option value="gradient">Gradient</option>
                <option value="pattern">Subtle pattern</option>
              </select>
            </div>
          </div>
        </section>

        <!-- Analytics tab -->
        <section class="editor-panel" id="panelAnalytics" role="tabpanel" aria-labelledby="tabAnalytics" hidden>
          <div class="panel-card">
            <h2 class="panel-title">Profile analytics</h2>
            <p class="panel-desc">See how many times your bio page has been viewed.</p>
            <div class="analytics-stats">
              <div class="analytics-stat">
                <span class="analytics-value" id="profileViewsCount">‚Äî</span>
                <span class="analytics-label">Profile views</span>
              </div>
            </div>
            <div class="form-group" style="margin-top: 1rem;">
              <label class="checkbox-label">
                <input type="checkbox" id="showViewsOnBio" aria-describedby="showViewsOnBioDesc">
                Show profile views on my bio link
              </label>
              <p class="panel-desc" id="showViewsOnBioDesc">When enabled, visitors will see your profile view count on your public bio page.</p>
            </div>
          </div>
        </section>

        <!-- SEO tab -->
        <section class="editor-panel" id="panelSeo" role="tabpanel" aria-labelledby="tabSeo" hidden>
          <div class="panel-card">
            <h2 class="panel-title">Metadata &amp; SEO</h2>
            <p class="panel-desc">Custom title and description when your link is shared on socials or search.</p>
            <div class="form-group">
              <label for="metaTitle">Page title</label>
              <input type="text" id="metaTitle" placeholder="Your name ‚Äî nightbio" maxlength="80">
            </div>
            <div class="form-group">
              <label for="metaDescription">Description</label>
              <textarea id="metaDescription" placeholder="Short description for search and social previews" maxlength="200" rows="3"></textarea>
              <span class="char-count"><span id="metaDescCount">0</span>/200</span>
            </div>
            <div class="form-group">
              <label for="metaImageURL">Preview image URL (optional)</label>
              <input type="text" id="metaImageURL" placeholder="https://... (OG image for shares)" maxlength="500">
            </div>
            <p class="panel-desc panel-desc-muted">Use a full URL (https://‚Ä¶) for the image. When someone opens your link in a browser, this title, description, and image are used. Some apps (e.g. Discord) cache previews and may not update immediately.</p>
          </div>
        </section>

        <!-- Badges tab -->
        <section class="editor-panel" id="panelBadges" role="tabpanel" aria-labelledby="tabBadges" hidden>
          <div class="panel-card badges-panel">
            <div class="badges-header">
              <h2 class="panel-title">All Badges</h2>
              <select id="badgesFilter" class="badges-filter-select" aria-label="Filter badges">
                <option value="all">All Badges</option>
                <option value="owned">On my profile</option>
                <option value="available">Available</option>
              </select>
            </div>
            <p class="panel-desc">Choose which badges appear on your profile. You can turn any badge on or off; admin-granted badges (OG, Staff, etc.) can be hidden or shown.</p>
            <div class="badges-grid" id="badgesList"></div>
            <div class="custom-badge-notice">
              <strong>Custom badge</strong>
              <p>Want your own custom badge? Join our server, open a ticket, and purchase a custom badge for $5 USD.</p>
            </div>
          </div>
        </section>

        <!-- Admin panel (only visible with staff badge) ‚Äî full staff dashboard -->
        <section class="editor-panel" id="panelStatus" role="tabpanel" aria-labelledby="tabStatus" hidden>
          <div class="panel-card status-widget-card">
            <h2 class="panel-title">System status</h2>
            <p class="panel-desc">Live status and response times for nightbio.lol. Auto-refresh every 60s.</p>
            <p class="status-widget-meta" id="dsStatusUpdated">Last checked: ‚Äî</p>
            <div class="status-overview-card" id="dsStatusOverview">
              <div class="status-overview-left">
                <span class="status-overview-dot checking" id="dsOverviewDot" aria-hidden="true"></span>
                <div>
                  <div class="status-overview-text" id="dsOverviewText">Checking all systems‚Ä¶</div>
                  <div class="status-overview-detail" id="dsOverviewDetail">Verifying website, authentication, and database</div>
                </div>
              </div>
              <button type="button" class="status-refresh-btn" id="dsStatusRefresh" aria-label="Refresh status">Refresh</button>
            </div>
            <h3 class="status-section-title">Services</h3>
            <div class="status-list">
              <div class="status-item">
                <div class="status-dot-wrap">
                  <span class="status-dot checking" id="dsDotWebsite" aria-label="Website status"></span>
                  <span class="status-tooltip" id="dsTooltipWebsite">Checking‚Ä¶</span>
                </div>
                <div>
                  <div class="status-item-label">Website</div>
                  <div class="status-item-desc">Homepage, dashboard, login, signup, and bio pages</div>
                </div>
                <div class="status-item-meta" id="dsMetaWebsite">‚Äî</div>
              </div>
              <div class="status-item">
                <div class="status-dot-wrap">
                  <span class="status-dot checking" id="dsDotApi" aria-label="Authentication status"></span>
                  <span class="status-tooltip" id="dsTooltipApi">Checking‚Ä¶</span>
                </div>
                <div>
                  <div class="status-item-label">Authentication</div>
                  <div class="status-item-desc">Firebase Auth ‚Äî sign in, sign up, password reset</div>
                </div>
                <div class="status-item-meta" id="dsMetaApi">‚Äî</div>
              </div>
              <div class="status-item">
                <div class="status-dot-wrap">
                  <span class="status-dot checking" id="dsDotDb" aria-label="Database status"></span>
                  <span class="status-tooltip" id="dsTooltipDb">Checking‚Ä¶</span>
                </div>
                <div>
                  <div class="status-item-label">Database</div>
                  <div class="status-item-desc">Firebase Realtime Database ‚Äî profiles, links, settings</div>
                </div>
                <div class="status-item-meta" id="dsMetaDb">‚Äî</div>
              </div>
            </div>
            <div class="status-legend">
              <span class="status-legend-item"><span class="status-legend-dot op" aria-hidden="true"></span> Operational</span>
              <span class="status-legend-item"><span class="status-legend-dot deg" aria-hidden="true"></span> Degraded</span>
              <span class="status-legend-item"><span class="status-legend-dot out" aria-hidden="true"></span> Outage</span>
            </div>
          </div>
        </section>
        <section class="editor-panel" id="panelAdminPanel" role="tabpanel" aria-labelledby="tabAdminPanel" hidden>
          <div class="da-wrap">
            <header class="da-header">
              <h2 class="da-title">Staff panel</h2>
              <button type="button" class="btn btn-ghost da-refresh" id="dashboardAdminRefresh" title="Refresh all">‚Üª Refresh</button>
            </header>
            <nav class="da-nav" role="tablist">
              <button type="button" class="da-nav-item active" data-section="overview" role="tab">Overview</button>
              <button type="button" class="da-nav-item" data-section="analytics" role="tab">Analytics</button>
              <button type="button" class="da-nav-item" data-section="activity" role="tab">Activity</button>
              <button type="button" class="da-nav-item" data-section="settings" role="tab">Settings</button>
              <button type="button" class="da-nav-item" data-section="maintenance" role="tab">Maintenance</button>
              <button type="button" class="da-nav-item" data-section="users" role="tab">Users</button>
              <button type="button" class="da-nav-item" data-section="banned" role="tab">Banned</button>
              <button type="button" class="da-nav-item" data-section="held" role="tab">Username holding</button>
              <button type="button" class="da-nav-item" data-section="export" role="tab">Export</button>
              <button type="button" class="da-nav-item" data-section="sitedata" role="tab">Site data</button>
              <button type="button" class="da-nav-item" data-section="security" role="tab">Security</button>
            </nav>
            <div class="da-body">
              <section id="daSectionOverview" class="da-section on">
                <div class="admin-page-header">
                  <h3 class="da-section-title">Overview</h3>
                  <p class="admin-meta" id="daOverviewLastUpdated">Click Refresh to load.</p>
                </div>
                <div class="admin-stats-grid">
                  <div class="admin-stat-card stat-accent"><div class="stat-value" id="daUserCount">0</div><div class="stat-label">Total users</div><div class="stat-detail">Registered accounts</div></div>
                  <div class="admin-stat-card"><div class="stat-value" id="daTotalViews">0</div><div class="stat-label">Profile views</div><div class="stat-detail">All-time</div></div>
                  <div class="admin-stat-card stat-error"><div class="stat-value" id="daBannedCount">0</div><div class="stat-label">Banned</div><div class="stat-detail">Blocked from sign-in</div></div>
                  <div class="admin-stat-card stat-success"><div class="stat-value" id="daActiveCount">0</div><div class="stat-label">Active</div><div class="stat-detail">Not banned</div></div>
                </div>
                <div class="admin-quick-actions">
                  <button type="button" class="btn btn-ghost da-quick" data-section="maintenance">Maintenance</button>
                  <button type="button" class="btn btn-ghost da-quick" data-section="users">Manage users</button>
                  <button type="button" class="btn btn-ghost da-quick" data-section="banned">View banned</button>
                </div>
                <div class="admin-card">
                  <div class="admin-card-header">Top 5 profiles by views</div>
                  <div class="admin-card-body">
                    <ul class="admin-top-list" id="daOverviewTopUsers"><li class="admin-empty">Loading‚Ä¶</li></ul>
                  </div>
                </div>
              </section>
              <section id="daSectionAnalytics" class="da-section">
                <div class="admin-page-header">
                  <h3 class="da-section-title">Analytics</h3>
                  <p>Top 20 by profile views.</p>
                </div>
                <div class="admin-card">
                  <div class="admin-card-body">
                    <ul class="admin-top-list" id="daAnalyticsTopUsers"></ul>
                  </div>
                </div>
              </section>
              <section id="daSectionActivity" class="da-section">
                <div class="admin-page-header">
                  <h3 class="da-section-title">Recent activity</h3>
                  <p>Last 25 signups.</p>
                </div>
                <div class="admin-card">
                  <div class="admin-card-body">
                    <ul class="admin-top-list" id="daActivityRecentSignups"></ul>
                  </div>
                </div>
              </section>
              <section id="daSectionSettings" class="da-section">
                <div class="admin-page-header">
                  <h3 class="da-section-title">Site settings</h3>
                  <p>Site name, tagline, signups, announcement.</p>
                </div>
                <div class="admin-card">
                  <div class="admin-card-body">
                    <div class="admin-field"><label for="daSettingsSiteName">Site name</label><input type="text" id="daSettingsSiteName" class="form-input" placeholder="nightbio" maxlength="80" /></div>
                    <div class="admin-field"><label for="daSettingsTagline">Tagline</label><input type="text" id="daSettingsTagline" class="form-input" placeholder="Your link in one place" maxlength="120" /></div>
                    <div class="admin-field">
                      <label class="admin-checkbox-label"><input type="checkbox" id="daSettingsAllowSignups" checked /> Allow new signups</label>
                      <span class="admin-field-hint">When off, new users cannot register.</span>
                    </div>
                    <div class="admin-field">
                      <label class="admin-checkbox-label"><input type="checkbox" id="daSettingsAnnouncementEnabled" /> Show site-wide announcement</label>
                      <textarea id="daSettingsAnnouncementText" class="form-input" rows="3" placeholder="Announcement text‚Ä¶" maxlength="500"></textarea>
                    </div>
                    <button type="button" class="btn btn-primary" id="daSettingsSave">Save settings</button>
                  </div>
                </div>
              </section>
              <section id="daSectionMaintenance" class="da-section">
                <div class="admin-page-header">
                  <h3 class="da-section-title">Maintenance mode</h3>
                  <p>When on, visitors see a full-screen message. Staff can still access the site.</p>
                </div>
                <div class="admin-card">
                  <div class="admin-card-body">
                    <div class="admin-toggle-wrap">
                      <div id="daMaintenanceToggle" class="admin-toggle" role="button" tabindex="0" aria-pressed="false"></div>
                      <span id="daMaintenanceLabel" class="admin-toggle-label">Maintenance mode is off</span>
                    </div>
                    <div class="admin-field">
                      <label for="daMaintenanceMessage">Message shown to visitors</label>
                      <textarea id="daMaintenanceMessage" class="form-input" rows="4" placeholder="We'll be back soon."></textarea>
                    </div>
                    <button type="button" class="btn btn-primary" id="daMaintenanceSave">Save</button>
                  </div>
                </div>
              </section>
              <section id="daSectionUsers" class="da-section">
                <div class="admin-page-header">
                  <h3 class="da-section-title">All users</h3>
                  <p class="admin-meta" id="dashboardAdminUsersCountLine">Load with Refresh.</p>
                </div>
                <div class="admin-toolbar">
                  <input type="text" id="dashboardAdminUserSearch" class="admin-search-input form-input" placeholder="Search username, name, or email‚Ä¶" style="max-width: 280px;" />
                  <select id="dashboardAdminUserFilter" class="admin-filter-select form-select" style="max-width: 140px;">
                    <option value="all">All</option>
                    <option value="banned">Banned only</option>
                    <option value="active">Active only</option>
                  </select>
                </div>
                <div class="admin-table-wrap">
                  <table class="admin-table">
                    <thead>
                      <tr>
                        <th>User</th>
                        <th>Username</th>
                        <th>Email</th>
                        <th>Views</th>
                        <th>Badges</th>
                        <th>Status</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody id="dashboardAdminUserList"></tbody>
                  </table>
                </div>
              </section>
              <section id="daSectionBanned" class="da-section">
                <div class="admin-page-header">
                  <h3 class="da-section-title">Banned users</h3>
                  <p class="admin-meta" id="daBannedCountLine"></p>
                </div>
                <div class="admin-card">
                  <div class="admin-card-body">
                    <ul class="admin-top-list" id="daBannedUserList"></ul>
                    <p id="daBannedEmpty" class="admin-empty" style="display: none;">No banned users.</p>
                  </div>
                </div>
              </section>
              <section id="daSectionHeld" class="da-section">
                <div class="admin-page-header">
                  <h3 class="da-section-title">Username holding</h3>
                  <p class="admin-card-desc">Held handles cannot be claimed as username or alias until removed. Add a username to reserve it.</p>
                </div>
                <div class="admin-card">
                  <div class="admin-card-body">
                    <div class="admin-field" style="margin-bottom: 1rem;">
                      <label for="daHeldUsernameInput">Add username to hold</label>
                      <div class="handle-change-row" style="display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap;">
                        <input type="text" id="daHeldUsernameInput" class="form-input" placeholder="e.g. admin" minlength="3" maxlength="20" pattern="[a-zA-Z0-9_]+" style="max-width: 200px;" />
                        <button type="button" class="btn btn-primary" id="daHeldUsernameAdd">Add</button>
                      </div>
                      <p id="daHeldUsernameMsg" class="form-hint" aria-live="polite" style="margin-top: 0.35rem;"></p>
                    </div>
                    <ul class="admin-top-list" id="daHeldUsernameList"></ul>
                    <p id="daHeldUsernameEmpty" class="admin-empty" style="display: none;">No usernames held.</p>
                  </div>
                </div>
              </section>
              <section id="daSectionExport" class="da-section">
                <div class="admin-page-header">
                  <h3 class="da-section-title">Export users</h3>
                  <p>Download full user list as CSV. Uses current loaded data ‚Äî Refresh first if needed.</p>
                </div>
                <div class="admin-card">
                  <div class="admin-card-body">
                    <button type="button" class="btn btn-primary" id="daExportCsvBtn">Download CSV</button>
                  </div>
                </div>
              </section>
              <section id="daSectionSiteData" class="da-section">
                <div class="admin-page-header">
                  <h3 class="da-section-title">Site data</h3>
                  <p>Download a full backup of all site data (users, usernames, aliases, settings, bans, etc.) or restore from a previously downloaded backup file. Restore overwrites current data.</p>
                </div>
                <div class="admin-card">
                  <div class="admin-card-body">
                    <div class="admin-field" style="margin-bottom: 1.25rem;">
                      <button type="button" class="btn btn-primary" id="daSiteDataDownloadBtn">Download backup</button>
                      <p class="admin-field-hint" style="margin-top: 0.35rem;">Saves a JSON file with the entire database snapshot (excluding admin UIDs which cannot be restored via this tool).</p>
                    </div>
                    <div class="admin-field">
                      <label for="daSiteDataFileInput">Restore from backup</label>
                      <div style="display: flex; align-items: center; gap: 0.5rem; flex-wrap: wrap;">
                        <input type="file" id="daSiteDataFileInput" class="da-site-data-file-input" accept=".json,application/json" aria-label="Choose backup file">
                        <button type="button" class="btn btn-ghost" id="daSiteDataRestoreBtn">Upload &amp; restore</button>
                      </div>
                      <p id="daSiteDataRestoreMsg" class="form-hint" aria-live="polite" style="margin-top: 0.35rem;"></p>
                      <p class="admin-field-hint" style="margin-top: 0.35rem;">Choose a backup JSON file and click Upload &amp; restore. This will replace all current site data with the file contents. Admin UIDs are not modified. Confirm when prompted.</p>
                    </div>
                  </div>
                </div>
              </section>
              <section id="daSectionSecurity" class="da-section">
                <div class="admin-page-header">
                  <h3 class="da-section-title">Admin UIDs</h3>
                  <p>UIDs in <code>adminUids</code> have full admin access. Edit in Firebase Console ‚Üí Realtime Database.</p>
                </div>
                <div class="admin-card">
                  <div class="admin-card-body">
                    <ul class="admin-top-list" id="daSecurityAdminList"></ul>
                  </div>
                </div>
              </section>
            </div>
          </div>
          <div id="dashboardAdminEditModal" class="admin-modal">
            <div class="admin-modal-box">
              <div class="admin-modal-header">Edit user</div>
              <div class="admin-modal-body">
                <input type="hidden" id="dashboardAdminEditUid" />
                <div class="admin-field">
                  <label for="dashboardAdminEditDisplayName">Display name</label>
                  <input type="text" id="dashboardAdminEditDisplayName" class="form-input" placeholder="Display name" />
                </div>
                <div class="admin-field">
                  <label for="dashboardAdminEditBio">Bio</label>
                  <textarea id="dashboardAdminEditBio" class="form-input" rows="4" placeholder="Short bio‚Ä¶"></textarea>
                </div>
                <div class="admin-field">
                  <label>Badges</label>
                  <div id="dashboardAdminEditBadgesList" class="admin-badges-grid"></div>
                </div>
              </div>
              <div class="admin-modal-footer">
                <button type="button" class="btn btn-ghost" id="dashboardAdminEditCancel">Cancel</button>
                <button type="button" class="btn btn-primary" id="dashboardAdminEditSave">Save changes</button>
              </div>
            </div>
          </div>
          <div id="dashboardAdminToast" class="admin-toast" style="display: none;"></div>
        </section>

        <!-- Premium tab (only visible with premium badge) -->
        <section class="editor-panel" id="panelPremium" role="tabpanel" aria-labelledby="tabPremium" hidden>
          <div class="panel-card premium-card">
            <h2 class="panel-title">Premium features</h2>
            <p class="panel-desc">Unlock these options with the Premium badge. Customize your profile with advanced styling and effects.</p>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Link styling</h2>
            <div class="form-group">
              <label for="premiumButtonShape">Button shape</label>
              <select id="premiumButtonShape" class="form-select">
                <option value="">Default</option>
                <option value="pill">Pill (fully rounded)</option>
                <option value="rounded">Rounded</option>
                <option value="square">Square</option>
              </select>
            </div>
            <div class="form-group">
              <label for="premiumLinkHoverEffect">Link hover effect</label>
              <select id="premiumLinkHoverEffect" class="form-select">
                <option value="">Default</option>
                <option value="glow">Glow</option>
                <option value="lift">Lift</option>
                <option value="scale">Scale</option>
                <option value="underline">Underline</option>
              </select>
            </div>
            <div class="form-group form-row">
              <div>
                <label for="premiumLinkFontSize">Link font size</label>
                <input type="number" id="premiumLinkFontSize" min="12" max="24" value="16" class="form-input-num" placeholder="16">
              </div>
              <div>
                <label for="premiumLinkBorderRadius">Link corner radius (px)</label>
                <input type="number" id="premiumLinkBorderRadius" min="0" max="50" value="8" class="form-input-num" placeholder="8">
              </div>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Username effects</h2>
            <p class="panel-desc">Animated effects on your display name (Premium).</p>
            <div class="form-group">
              <label for="premiumUsernameEffect">Effect</label>
              <select id="premiumUsernameEffect" class="form-select">
                <option value="">None</option>
                <option value="typewriter">Typewriter</option>
                <option value="rainbow">Rainbow</option>
                <option value="fuzzy">Fuzzy</option>
                <option value="shuffle">Shuffle</option>
              </select>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Glow settings</h2>
            <p class="panel-desc">Add a soft glow to elements on your profile.</p>
            <div class="form-group form-check">
              <input type="checkbox" id="premiumGlowUsername" class="form-checkbox">
              <label for="premiumGlowUsername">Username glow</label>
            </div>
            <div class="form-group form-check">
              <input type="checkbox" id="premiumGlowSocials" class="form-checkbox">
              <label for="premiumGlowSocials">Socials / links glow</label>
            </div>
            <div class="form-group form-check">
              <input type="checkbox" id="premiumGlowBadges" class="form-checkbox">
              <label for="premiumGlowBadges">Badges glow</label>
            </div>
            <div class="form-group form-check">
              <input type="checkbox" id="premiumMonochromeBadges" class="form-checkbox">
              <label for="premiumMonochromeBadges">Monochrome badges</label>
              <p class="panel-desc">Show badges in grayscale instead of colored.</p>
            </div>
            <div class="form-group form-check">
              <input type="checkbox" id="premiumGlowBio" class="form-checkbox">
              <label for="premiumGlowBio">Bio text glow</label>
            </div>
            <div class="form-group">
              <label for="premiumGlowColor">Glow color</label>
              <div class="color-picker-wrap">
                <input type="color" id="premiumGlowColor" value="#7c6bb8" aria-label="Glow color">
                <input type="text" id="premiumGlowColorHex" class="color-hex-input" value="#7c6bb8" maxlength="7" placeholder="#7c6bb8">
              </div>
              <p class="panel-desc">Color used for username, socials, badges, and bio glow. Leave default or pick a custom color.</p>
            </div>
            <div class="form-group">
              <label for="premiumGlowStrength">Glow strength</label>
              <input type="range" id="premiumGlowStrength" min="25" max="200" value="100" class="form-range" aria-label="Glow strength">
              <span id="premiumGlowStrengthValue" class="form-range-value">100%</span>
              <p class="panel-desc">How strong the glow appears. 100% is default; lower is subtler, higher is more intense.</p>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Name &amp; bio</h2>
            <div class="form-group">
              <label for="premiumNameColor">Name color</label>
              <div class="color-picker-wrap">
                <input type="color" id="premiumNameColor" value="#ffffff" aria-label="Display name color">
                <input type="text" id="premiumNameColorHex" class="color-hex-input" value="#ffffff" maxlength="7" placeholder="#ffffff">
              </div>
              <p class="panel-desc">Color of your display name. Leave default (white) or pick any color.</p>
            </div>
            <div class="form-group">
              <label for="premiumBioFontSize">Bio font size (px)</label>
              <input type="number" id="premiumBioFontSize" min="12" max="24" value="15" class="form-input-num" placeholder="15">
            </div>
            <div class="form-group form-check">
              <input type="checkbox" id="typewriterBio" class="form-checkbox">
              <label for="typewriterBio">Typewriter effect on bio (Premium)</label>
            </div>
            <div class="form-group">
              <label for="premiumCustomFontFamily">Premium font (Google Font family name)</label>
              <input type="text" id="premiumCustomFontFamily" placeholder="e.g. Sora" class="form-input" maxlength="80">
              <p class="panel-desc">Optional. Overrides the font dropdown on your public bio.</p>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Layout presets</h2>
            <p class="panel-desc">Extra premium looks. These stack on top of your normal Layout style.</p>
            <div class="form-group">
              <label for="premiumLayoutPreset">Preset</label>
              <select id="premiumLayoutPreset" class="form-select">
                <option value="">Default</option>
                <option value="sleek">Sleek</option>
                <option value="modern">Modern</option>
                <option value="simplistic">Simplistic</option>
              </select>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Motion</h2>
            <div class="form-group">
              <label for="premiumProfileAnimation">Profile animation</label>
              <select id="premiumProfileAnimation" class="form-select">
                <option value="">None</option>
                <option value="float">Float</option>
                <option value="fadeUp">Fade up</option>
                <option value="glowPulse">Glow pulse</option>
              </select>
            </div>
            <div class="form-group form-check">
              <input type="checkbox" id="premiumParallax" class="form-checkbox">
              <label for="premiumParallax">Parallax profile animation (banner/avatar)</label>
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Background &amp; media</h2>
            <div class="form-group">
              <label for="premiumBackgroundEffect">Background effect</label>
              <select id="premiumBackgroundEffect" class="form-select">
                <option value="">None</option>
                <option value="blurred">Blurred background</option>
              </select>
              <p class="panel-desc">Blurred uses your cover/avatar as a soft background. No particle effects.</p>
            </div>
            <div class="form-group">
              <label for="premiumVideoBackground">Video background URL</label>
              <input type="url" id="premiumVideoBackground" placeholder="https://... (video URL)" class="form-input" maxlength="500">
              <p class="panel-desc">Optional. A looping video behind your profile (e.g. MP4). Leave empty for static background.</p>
            </div>
            <div class="form-group">
              <label for="premiumBannerBlur">Cover image blur (0 = none)</label>
              <input type="number" id="premiumBannerBlur" min="0" max="20" value="0" class="form-input-num" placeholder="0">
            </div>
            <div class="form-group">
              <label for="premiumAvatarBorder">Avatar border (CSS)</label>
              <input type="text" id="premiumAvatarBorder" placeholder="e.g. 3px solid #7c6bb8" class="form-input" maxlength="100">
            </div>
          </div>
          <div class="panel-card">
            <h2 class="panel-title">Advanced</h2>
            <div class="form-group form-check">
              <input type="checkbox" id="premiumHideBranding" class="form-checkbox">
              <label for="premiumHideBranding">Hide ‚Äúnightbio.lol‚Äù footer on profile</label>
            </div>
            <div class="form-group">
              <label for="premiumCustomCSS">Custom CSS (snippet)</label>
              <textarea id="premiumCustomCSS" placeholder=".bio-name { letter-spacing: 0.1em; }" rows="4" class="form-input" maxlength="2000"></textarea>
              <p class="panel-desc">Optional. Applied only on your public bio. Keep it short and safe.</p>
            </div>
          </div>
        </section>
      </div>
    </div>

    <aside class="editor-preview" id="dashboardPreviewWrap">
      <div class="preview-phone-float">
        <div class="preview-phone" id="dashboardPreviewPhone">
          <div class="preview-phone-notch"></div>
          <div class="preview-screen" id="previewScreen">
          <div class="preview-banner" id="previewBanner"></div>
          <div class="preview-profile">
            <div class="preview-avatar-wrap" id="previewAvatarWrap">
              <img id="previewAvatar" class="preview-avatar" src="" alt="" style="display: none;">
              <div class="preview-avatar-placeholder" id="previewAvatarPlaceholder">?</div>
            </div>
            <div class="preview-name" id="previewName">Your name</div>
            <div class="preview-alias" id="previewAlias"></div>
            <div class="preview-badges" id="previewBadges"></div>
            <div class="preview-bio" id="previewBio">Your bio appears here.</div>
            <div class="preview-links" id="previewLinks"></div>
          </div>
        </div>
        </div>
      </div>
    </aside>
  </main>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
  <script src="firebase-config.js"></script>
  <script src="auth.js"></script>
  <script src="badge-icons.js"></script>
  <script src="link-platforms.js"></script>
  <script src="bio.js"></script>
  <script src="admin.js"></script>
  <script src="maintenance.js"></script>
  <script src="dashboard-editor.js"></script>
  <script>
    (function() {
      initFirebase();
      var auth = getAuth();
      document.getElementById('logoutBtn').addEventListener('click', function() {
        auth.signOut().then(function() { window.location.href = 'index'; });
      });
      auth.onAuthStateChanged(function(user) {
        if (!user) {
          window.location.href = 'login';
          return;
        }
        if (!user.emailVerified) {
          auth.signOut();
          window.location.href = 'login?verified=0';
          return;
        }
        if (typeof isUserBanned === 'function') {
          isUserBanned(user.uid).then(function(banned) {
            if (banned) {
              auth.signOut();
              window.location.href = '/banned?type=account';
              return;
            }
            window.dashboardEditor && window.dashboardEditor.init(user.uid);
          });
        } else {
          window.dashboardEditor && window.dashboardEditor.init(user.uid);
        }
      });
    })();
  </script>
  <script src="translate.js"></script>
  <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</body>
</html>
